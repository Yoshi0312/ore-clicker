# 鉱石破壊クリッカーゲーム 仕様書（v0.2）

## 1. ゲーム概要

### タイトル（仮）
Ore Breaker Incremental

### ジャンル
クリック型インクリメンタルゲーム（暇つぶし）

### コンセプト
鉱山を探索し、複数の鉱石を同時に破壊。
資源を集めてツール・スキル・仲間を解放し、破壊能力を成長させていく。
**「選択の楽しさ」と「成長の実感」** を重視。

---

## 2. 基本ゲームループ

```
フィールド上の鉱石をクリック
    ↓
ダメージ → 破壊 → 資源獲得
    ↓
資源で強化・スキル解放
    ↓
新しい鉱石種・エリアが解放
    ↓
より効率的な破壊へ
```

### ループの面白さのポイント
- **複数鉱石の選択**: どれを先に壊すか戦略性
- **コンボ/連鎖**: 素早く壊すとボーナス
- **スキル発動**: タイミングを見計らう楽しさ
- **解放の喜び**: 新要素が次々とアンロック

---

## 3. 画面構成

### メインレイアウト

```
┌─────────────────────────────────────────────┐
│  [資源表示バー]  💎 1,234  ⚡ 56 (エネルギー) │
├─────────────────────────────────────────────┤
│                                             │
│     ┌───┐  ┌───┐  ┌───┐                     │
│     │鉱1│  │鉱2│  │鉱3│   ← フィールド      │
│     └───┘  └───┘  └───┘     (3〜6個の鉱石)  │
│        ┌───┐  ┌───┐                         │
│        │鉱4│  │鉱5│                         │
│        └───┘  └───┘                         │
│                                             │
│  [コンボ: x3]  [フィーバー！]               │
├─────────────────────────────────────────────┤
│  [ステータス]     │  [強化メニュー]          │
│  破壊力: 5        │  🔨 ピッケル強化  [15]   │
│  クリティカル: 5% │  ⚡ スキル: 連撃  [50]   │
│  コンボ倍率: x1.2 │  👷 仲間: 見習い  [100]  │
├─────────────────────────────────────────────┤
│  [スキルバー]  [連撃] [粉砕] [??] [??]       │
└─────────────────────────────────────────────┘
```

---

## 4. フィールドシステム（NEW）

### 概要
画面上に **3〜6個の鉱石** が同時に配置される。
破壊すると新しい鉱石が補充される。

### フィールド仕様

```js
field = {
  maxSlots: 5,          // 最大配置数（アップグレードで増加）
  ores: [],             // 現在配置されている鉱石
  spawnTable: [...],    // 出現テーブル（確率ベース）
  rareBonus: false      // レア鉱石出現中フラグ
}
```

### 鉱石の出現ルール
- 破壊されると即座に新しい鉱石が出現
- 出現する鉱石は **確率テーブル** で決定
- 累計資源に応じて上位鉱石の出現率UP
- 稀に **レア鉱石**（金色エフェクト）が出現

### 出現確率テーブル（例：序盤）

| 鉱石   | 基本確率 | 条件              |
|--------|----------|-------------------|
| 石     | 60%      | 初期              |
| 銅     | 30%      | 累計50以上        |
| 鉄     | 10%      | 累計200以上       |
| 銀(レア)| 2%      | 累計100以上       |

---

## 5. 鉱石（Ore）仕様 - 調整版

### バランス調整方針
- **序盤のクリック数を削減**（10回 → 3〜5回で破壊）
- **報酬を細分化**（資源 + 経験値 + 稀にドロップ）

### 鉱石データ構造

```js
{
  id: "stone",
  name: "石",
  maxHp: 3,              // 調整: 10 → 3
  baseReward: 1,
  expReward: 1,
  dropTable: [],         // 特殊ドロップ
  color: "#888888",
  isRare: false
}
```

### 鉱石テーブル（調整版）

| 鉱石       | HP  | 資源 | 経験値 | 出現条件      | 備考           |
|------------|-----|------|--------|---------------|----------------|
| 石         | 3   | 1    | 1      | 初期          |                |
| 銅鉱石     | 5   | 2    | 2      | 累計30        |                |
| 鉄鉱石     | 8   | 4    | 3      | 累計100       |                |
| 銀鉱石     | 6   | 8    | 5      | 累計100       | レア(5%)       |
| 金鉱石     | 10  | 15   | 8      | 累計300       | レア(3%)       |
| アルミ鉱石 | 15  | 10   | 6      | 累計500       |                |
| 水晶       | 20  | 25   | 12     | 累計1000      |                |
| ダイヤ     | 40  | 80   | 30     | 累計3000      |                |
| ダークマター| 100| 300  | 100    | 累計10000     | ボス級         |

---

## 6. プレイヤーステータス - 拡張版

### ステータス構造

```js
player = {
  // 基本
  power: 1,              // 基礎ダメージ
  resources: 0,          // 所持資源
  totalResources: 0,     // 累計資源
  
  // 成長システム
  level: 1,              // プレイヤーレベル
  exp: 0,                // 経験値
  expToNext: 10,         // 次レベルまで
  skillPoints: 0,        // スキルポイント
  
  // 戦闘ステータス
  critChance: 0,         // クリティカル率 (%)
  critMultiplier: 2.0,   // クリティカル倍率
  multiHit: 1,           // 同時攻撃数
  
  // エネルギー（スキル用）
  energy: 0,
  maxEnergy: 100,
  energyRegen: 1,        // 毎秒回復量
  
  // コンボ
  combo: 0,
  comboTimer: 0,
  maxComboBonus: 0.5     // 最大コンボボーナス(+50%)
}
```

### レベルアップシステム

```js
// レベルアップ時
onLevelUp() {
  player.level++;
  player.skillPoints += 1;
  player.power += 0.5;           // 自動で少し強くなる
  player.expToNext *= 1.5;       // 必要経験値増加
  
  // 特定レベルで解放
  checkUnlocks(player.level);
}
```

### レベル解放テーブル

| レベル | 解放内容                    |
|--------|------------------------------|
| 1      | ゲーム開始                   |
| 3      | スキル「連撃」               |
| 5      | 強化「クリティカル」         |
| 7      | フィールド枠+1               |
| 10     | スキル「粉砕」               |
| 15     | 仲間システム                 |
| 20     | 転生システム                 |

---

## 7. コンボシステム（NEW）

### 仕様
- 鉱石を破壊するとコンボ+1
- **2秒以内** に次を破壊しないとリセット
- コンボ数に応じてダメージボーナス

### コンボボーナス

| コンボ | ボーナス | 表示       |
|--------|----------|------------|
| 1-4    | +0%      | なし       |
| 5-9    | +10%     | COMBO x5!  |
| 10-19  | +25%     | GREAT!     |
| 20-49  | +50%     | EXCELLENT! |
| 50+    | +100%    | FEVER!!!   |

---

## 8. スキルシステム（NEW）

### 概要
エネルギーを消費して発動するアクティブ能力。
レベルアップやスキルポイントで習得・強化。

### スキルデータ構造

```js
{
  id: "multi_strike",
  name: "連撃",
  description: "3秒間、クリックが2回分になる",
  energyCost: 30,
  cooldown: 15,        // 秒
  duration: 3,         // 効果時間
  unlockLevel: 3,
  unlocked: false
}
```

### スキル一覧

| スキル名     | 効果                           | コスト | CT  | 解放Lv |
|--------------|--------------------------------|--------|-----|--------|
| 連撃         | 3秒間クリック2倍               | 30     | 15s | 3      |
| 粉砕         | 全鉱石に現在HPの30%ダメージ    | 50     | 30s | 10     |
| 黄金の目     | 10秒間レア出現率3倍            | 40     | 45s | 12     |
| エナジーバースト | エネルギー全回復           | 0      | 60s | 8      |
| 一撃必殺     | 1体を即破壊（ボス除く）        | 80     | 90s | 18     |

---

## 9. 強化（Upgrade）システム - 拡張版

### カテゴリ分け

```
強化メニュー
├── 🔨 ツール（基礎ステータス）
│   ├── ピッケル強化 → power +1
│   ├── 強化ピッケル → power +5
│   └── 伝説のピッケル → power +25
│
├── ⚡ 能力（特殊効果）
│   ├── 鋭い目 → critChance +2%
│   ├── 会心の一撃 → critMultiplier +0.5
│   └── 連続攻撃 → multiHit +1
│
├── 🏗️ 設備（自動化・効率）
│   ├── 自動採掘機 → 毎秒1ダメージ
│   ├── エネルギー炉 → energyRegen +1
│   └── 拡張フィールド → maxSlots +1
│
└── 👷 仲間（後述）
```

### 強化データ構造

```js
{
  id: "pickaxe_1",
  name: "ピッケル強化",
  description: "破壊力 +1",
  category: "tool",
  baseCost: 5,           // 調整: 10 → 5
  costMultiplier: 1.4,   // 調整: 1.5 → 1.4
  maxLevel: 50,
  currentLevel: 0,
  effect: { stat: "power", value: 1 },
  unlockCondition: null
}
```

### 初期強化テーブル（コスト調整済み）

| 強化名           | 効果           | 初期コスト | 倍率 | 解放条件       |
|------------------|----------------|------------|------|----------------|
| ピッケル強化     | power +1       | 5          | 1.4  | 初期           |
| 鋭い目           | critChance +2% | 20         | 1.6  | Lv5            |
| 自動採掘機Lv1    | 毎秒1ダメージ  | 50         | 2.0  | 累計200        |
| 強化ピッケル     | power +5       | 100        | 1.5  | ピッケルLv10   |
| エネルギー炉     | energyRegen +1 | 80         | 1.8  | Lv8            |
| フィールド拡張   | maxSlots +1    | 200        | 3.0  | 累計500        |

---

## 10. 仲間システム（NEW）

### 概要
資源を使って仲間を雇用。自動で採掘してくれる。
Cookie Clickerの「グランマ」的な存在。

### 仲間データ構造

```js
{
  id: "apprentice",
  name: "見習い鉱夫",
  description: "毎秒0.5ダメージを与える",
  baseCost: 100,
  costMultiplier: 1.15,
  dps: 0.5,              // Damage Per Second
  count: 0,
  unlockLevel: 15
}
```

### 仲間一覧

| 仲間名         | 基礎DPS | 初期コスト | 解放条件   |
|----------------|---------|------------|------------|
| 見習い鉱夫     | 0.5     | 100        | Lv15       |
| 熟練鉱夫       | 2       | 500        | Lv20       |
| 採掘ロボ       | 10      | 3000       | Lv30       |
| ドワーフ軍団   | 50      | 20000      | 転生1回    |
| 古代ゴーレム   | 250     | 150000     | 転生3回    |

---

## 11. 転生（Prestige）システム

### 概要
ゲームをリセットして「星の欠片」を獲得。
恒久的なボーナスを得られる。

### 転生条件
- 累計資源 10,000 以上
- ダークマターを1回破壊

### 転生報酬

```js
starFragments = floor(sqrt(totalResources / 1000))
```

### 星の欠片ボーナス

| 欠片数 | ボーナス                    |
|--------|------------------------------|
| 各1個  | 全ダメージ +5%               |
| 5個    | 初期power 2 でスタート       |
| 10個   | スキル「時の加速」解放       |
| 25個   | 仲間コスト -10%              |
| 50個   | レア出現率 +5%               |

---

## 12. 演出・フィードバック

### クリック時
- 鉱石が揺れる（CSS animation）
- ダメージ数値がポップアップ
- クリティカル時は大きく＋色変化

### 破壊時
- パーティクルエフェクト（破片が散る）
- 獲得資源が浮かび上がる
- 効果音（オプション）

### コンボ・スキル
- コンボ数が画面に大きく表示
- スキル発動時にフラッシュ
- フィーバー時は背景色変化

---

## 13. 状態管理

```js
const gameState = {
  player: { ... },
  field: { ... },
  upgrades: [ ... ],
  skills: [ ... ],
  companions: [ ... ],
  prestige: {
    totalResets: 0,
    starFragments: 0,
    bonuses: {}
  },
  settings: {
    soundEnabled: true,
    particlesEnabled: true
  },
  stats: {
    totalClicks: 0,
    totalOresBroken: 0,
    playTime: 0,
    highestCombo: 0
  }
}
```

---

## 14. 保存・ロード

- localStorage使用
- 30秒ごとに自動保存
- 手動保存/ロード/リセットボタン
- エクスポート/インポート機能（base64）

---

## 15. 実装優先度

### Phase 1（MVP）
- [x] 基本クリック処理
- [ ] フィールドシステム（複数鉱石）
- [ ] 調整済み鉱石テーブル
- [ ] 基本強化（ピッケル、クリティカル）
- [ ] コンボシステム

### Phase 2
- [ ] レベル・経験値システム
- [ ] スキルシステム（2〜3種）
- [ ] 演出強化（アニメーション）
- [ ] セーブ/ロード

### Phase 3
- [ ] 仲間システム
- [ ] 残りのスキル
- [ ] レア鉱石・ドロップ

### Phase 4
- [ ] 転生システム
- [ ] 実績
- [ ] エリア拡張

---

## 16. 技術仕様

- **1ファイルHTML + CSS + JS**
- フレームワーク不使用
- ES6構文
- requestAnimationFrame でゲームループ
- CSS変数でテーマ管理

---

## 17. 補足：面白さの設計ポイント

### 短期的な楽しさ
- コンボを繋げる気持ちよさ
- クリティカルの爽快感
- スキル発動の派手さ

### 中期的な楽しさ
- 新しい強化の解放
- スキル習得の選択
- 仲間が増える成長感

### 長期的な楽しさ
- 転生による恒久強化
- レア鉱石コンプリート
- 実績解除
